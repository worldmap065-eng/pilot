<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Pilot Studio | Live Editor</title>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Studio UI Styles --- */
        :root { 
            --accent: #0A84FF; 
            --bg: #1e1e1e; 
            --panel: #252526; 
            --border: #333;
            --text-main: #fff;
            --text-dim: #aaa;
        }
        * { box-sizing: border-box; font-family: 'SF Pro Display', sans-serif; }
        body { margin: 0; background: var(--bg); color: var(--text-main); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* Top Bar */
        .header {
            height: 50px; background: #2d2d2d; border-bottom: 1px solid var(--border);
            display: flex; align-items: center; justify-content: space-between; padding: 0 20px;
        }
        .brand { font-weight: 700; letter-spacing: 0.5px; font-size: 14px; }
        .actions { display: flex; gap: 10px; }
        .btn { 
            background: #3a3a3a; border: none; color: white; padding: 6px 12px; 
            border-radius: 6px; font-size: 12px; cursor: pointer; transition: 0.2s;
        }
        .btn:hover { background: #444; }
        .btn-primary { background: var(--accent); }
        .btn-primary:hover { background: #0077ed; }

        /* Workspace Layout */
        .workspace { flex: 1; display: flex; overflow: hidden; }

        /* Left Sidebar - Elements */
        .sidebar-left {
            width: 60px; background: var(--panel); border-left: 1px solid var(--border);
            display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 15px;
        }
        .tool-icon {
            width: 40px; height: 40px; border-radius: 8px; background: #333; color: #ccc;
            display: flex; justify-content: center; align-items: center; font-size: 18px; cursor: pointer;
            transition: 0.2s;
        }
        .tool-icon:hover { background: var(--accent); color: white; }

        /* Center - The Live Site */
        .stage {
            flex: 1; background: #111; display: flex; justify-content: center; align-items: center;
            padding: 40px; overflow: hidden; position: relative;
        }
        
        /* The Actual Website Frame */
        iframe {
            width: 100%; height: 100%; border: none; background: white;
            box-shadow: 0 0 40px rgba(0,0,0,0.5); transition: 0.4s ease;
        }
        /* Mobile View State */
        iframe.mobile-view {
            width: 375px; height: 812px; border-radius: 40px; border: 10px solid #000;
        }

        /* Right Sidebar - Properties */
        .sidebar-right {
            width: 280px; background: var(--panel); border-right: 1px solid var(--border);
            display: flex; flex-direction: column; padding: 20px; gap: 20px;
        }
        
        .prop-group { border-bottom: 1px solid #383838; padding-bottom: 15px; }
        .prop-title { font-size: 11px; font-weight: 700; color: var(--text-dim); text-transform: uppercase; margin-bottom: 10px; }
        
        .prop-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .prop-label { font-size: 12px; color: #ccc; }
        
        .input-field {
            background: #111; border: 1px solid #444; color: white; padding: 6px; 
            border-radius: 4px; font-size: 12px; width: 140px; outline: none;
        }
        .input-field:focus { border-color: var(--accent); }
        input[type="color"] { padding: 0; width: 40px; height: 30px; cursor: pointer; }

        #selection-status { font-size: 12px; color: var(--accent); text-align: center; margin-bottom: 10px; height: 15px; }

    </style>
</head>
<body>

    <header class="header">
        <div class="brand">PILOT LIVE ENGINE</div>
        <div class="actions">
            <button class="btn" onclick="setView('desktop')">ğŸ–¥ï¸ Desktop</button>
            <button class="btn" onclick="setView('mobile')">ğŸ“± iPhone</button>
            <button class="btn btn-primary" onclick="publish()">Publish Changes</button>
        </div>
    </header>

    <div class="workspace">
        <main class="stage">
            <iframe id="site-frame" src="index.html"></iframe>
        </main>

        <aside class="sidebar-right">
            <div id="selection-status">×œ× × ×‘×—×¨ ××œ×× ×˜</div>

            <div class="prop-group">
                <div class="prop-title">×ª×•×›×Ÿ (Content)</div>
                <div class="prop-row">
                    <span class="prop-label">×˜×§×¡×˜</span>
                    <input type="text" id="ctrl-text" class="input-field" placeholder="×‘×—×¨ ×˜×§×¡×˜...">
                </div>
            </div>

            <div class="prop-group">
                <div class="prop-title">×¢×™×¦×•×‘ (Style)</div>
                <div class="prop-row">
                    <span class="prop-label">×¦×‘×¢ ×˜×§×¡×˜</span>
                    <input type="color" id="ctrl-color" class="input-field">
                </div>
                <div class="prop-row">
                    <span class="prop-label">×¦×‘×¢ ×¨×§×¢</span>
                    <input type="color" id="ctrl-bg" class="input-field">
                </div>
                <div class="prop-row">
                    <span class="prop-label">×’×•×“×œ ×¤×•× ×˜ (px)</span>
                    <input type="number" id="ctrl-size" class="input-field">
                </div>
                <div class="prop-row">
                    <span class="prop-label">×¤×™× ×•×ª (Radius)</span>
                    <input type="number" id="ctrl-radius" class="input-field">
                </div>
            </div>

            <div class="prop-group">
                <div class="prop-title">×¤×¢×•×œ×•×ª</div>
                <button class="btn" style="width:100%; background:#ff3b30;" onclick="deleteEl()">ğŸ—‘ï¸ ××—×§ ××œ×× ×˜</button>
            </div>
        </aside>
    </div>

<script>
    const iframe = document.getElementById('site-frame');
    let selectedEl = null;

    // 1. ×›×©×”××™×™×¤×¨×™×™× ××¡×™×™× ×œ×”×™×˜×¢×Ÿ - ××–×¨×™×§×™× ××ª ×”×§×¡× ×¤× ×™××”
    iframe.onload = function() {
        const doc = iframe.contentDocument || iframe.contentWindow.document;
        
        // ×”×–×¨×§×ª CSS ×œ×¡×™××•×Ÿ ××œ×× ×˜×™×
        const style = doc.createElement('style');
        style.textContent = `
            * { cursor: default !important; }
            .pilot-hover { outline: 2px dashed #0A84FF !important; }
            .pilot-selected { outline: 3px solid #0A84FF !important; z-index: 1000; position: relative; }
        `;
        doc.head.appendChild(style);

        // ×”×•×¡×¤×ª ×××–×™× ×™× ×œ×›×œ ×”××œ×× ×˜×™× ×‘××ª×¨
        doc.body.addEventListener('mouseover', (e) => {
            if (e.target !== doc.body) e.target.classList.add('pilot-hover');
        });
        doc.body.addEventListener('mouseout', (e) => {
            e.target.classList.remove('pilot-hover');
        });
        
        doc.body.addEventListener('click', (e) => {
            e.preventDefault(); // ××•× ×¢ ××§×™×©×•×¨×™× ×œ×¢×‘×•×“
            e.stopPropagation();
            if(e.target !== doc.body) selectElement(e.target);
        });

        console.log("Pilot Engine Injected into index.html");
    };

    // 2. ×¤×•× ×§×¦×™×™×ª ×”×‘×—×™×¨×” (××—×‘×¨×ª ××ª ×”××œ×× ×˜ ×œ×›×¤×ª×•×¨×™×)
    function selectElement(el) {
        const doc = iframe.contentDocument;
        
        // × ×™×§×•×™ ×‘×—×™×¨×” ×§×•×“××ª
        const prev = doc.querySelector('.pilot-selected');
        if(prev) prev.classList.remove('pilot-selected');

        selectedEl = el;
        selectedEl.classList.add('pilot-selected');

        // ×¢×“×›×•×Ÿ ×”×¡×˜×˜×•×¡ ×œ××¢×œ×”
        document.getElementById('selection-status').innerText = "× ×¢×¨×š: " + el.tagName;

        // ×˜×¢×™× ×ª ×”× ×ª×•× ×™× ××”××œ×× ×˜ ×œ×©×“×•×ª ×‘×¦×“ ×™××™×Ÿ
        document.getElementById('ctrl-text').value = el.innerText;
        
        // ×”××¨×ª ×¦×‘×¢×™× ×•×¢×¨×›×™×
        const computed = window.getComputedStyle(el); // ×”×¢×¨×”: ×–×” ×œ×•×§×— ×¡×˜×™×™×œ ××”×—×œ×•×Ÿ ×”×¨××©×™, ×œ×“×™×•×§ ×¦×¨×™×š iframe window ××‘×œ ×–×” ××¡×¤×™×§ ×œ×”×ª×—×œ×”
        const elStyle = el.style;
        
        document.getElementById('ctrl-size').value = parseInt(iframe.contentWindow.getComputedStyle(el).fontSize);
        document.getElementById('ctrl-radius').value = parseInt(iframe.contentWindow.getComputedStyle(el).borderRadius) || 0;
        
        // ×”××¨×ª ×¦×‘×¢ RGB ×œ-HEX ×¢×‘×•×¨ ×©×“×” ×”-Input Color
        document.getElementById('ctrl-color').value = rgbToHex(iframe.contentWindow.getComputedStyle(el).color);
        document.getElementById('ctrl-bg').value = rgbToHex(iframe.contentWindow.getComputedStyle(el).backgroundColor);
    }

    // 3. ×¤×•× ×§×¦×™×•×ª ×”×¢×“×›×•×Ÿ ×‘×–××Ÿ ×××ª (Live Update)
    
    // ×˜×§×¡×˜
    document.getElementById('ctrl-text').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.innerText = e.target.value;
    });

    // ×’×•×“×œ ×¤×•× ×˜
    document.getElementById('ctrl-size').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.style.fontSize = e.target.value + 'px';
    });

    // ×¦×‘×¢ ×˜×§×¡×˜
    document.getElementById('ctrl-color').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.style.color = e.target.value;
    });

    // ×¦×‘×¢ ×¨×§×¢
    document.getElementById('ctrl-bg').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.style.backgroundColor = e.target.value;
    });

    // ×¨×“×™×•×¡
    document.getElementById('ctrl-radius').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.style.borderRadius = e.target.value + 'px';
    });

    // ××—×™×§×”
    function deleteEl() {
        if(selectedEl && confirm("×‘×˜×•×— ×œ××—×•×§?")) {
            selectedEl.remove();
            selectedEl = null;
            document.getElementById('ctrl-text').value = "";
        }
    }

    // ×ª×¦×•×’×”
    function setView(mode) {
        if(mode === 'mobile') iframe.classList.add('mobile-view');
        else iframe.classList.remove('mobile-view');
    }

    function publish() {
        alert("×”×©×™× ×•×™×™× × ×©××¨×•! (×›×“×™ ×œ×©××•×¨ ×‘×××ª ×¦×¨×™×š ×¦×“ ×©×¨×ª, ×›×¨×’×¢ ×–×” ××§×•××™ ×‘×“×¤×“×¤×Ÿ)");
    }

    // ×¤×•× ×§×¦×™×™×ª ×¢×–×¨ ×œ×”××¨×ª ×¦×‘×¢×™×
    function rgbToHex(rgb) {
        if(!rgb || rgb === 'rgba(0, 0, 0, 0)') return '#ffffff';
        const rgbValues = rgb.match(/\d+/g);
        if(!rgbValues) return '#000000';
        return "#" + ((1 << 24) + (parseInt(rgbValues[0]) << 16) + (parseInt(rgbValues[1]) << 8) + parseInt(rgbValues[2])).toString(16).slice(1);
    }
</script>

</body>
</html>
