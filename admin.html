// משתנה שיחזיק את האלמנט שנבחר כרגע
let selectedElement = null;

// 1. האזנה ללחיצות בתוך האתר
document.getElementById('site-wrapper').addEventListener('click', function(e) {
    if (e.target.classList.contains('editable')) {
        selectElement(e.target);
    }
});

// 2. פונקציית הבחירה
function selectElement(el) {
    // נקה בחירה קודמת
    if (selectedElement) selectedElement.classList.remove('selected');
    
    selectedElement = el;
    selectedElement.classList.add('selected');

    // עדכן את השדות בצד ימין בערכים של האלמנט
    document.getElementById('prop-text').value = el.innerText;
    
    const style = window.getComputedStyle(el);
    document.getElementById('prop-size').value = parseInt(style.fontSize);
}

// 3. עדכון בזמן אמת מהשדות לאתר
document.getElementById('prop-text').addEventListener('input', (e) => {
    if (selectedElement) selectedElement.innerText = e.target.value;
});

document.getElementById('prop-color').addEventListener('input', (e) => {
    if (selectedElement) selectedElement.style.color = e.target.value;
});

document.getElementById('prop-size').addEventListener('input', (e) => {
    if (selectedElement) selectedElement.style.fontSize = e.target.value + 'px';
});

// 4. פונקציות עזר
function addElement(type) {
    const newEl = document.createElement(type);
    newEl.className = 'editable';
    newEl.innerText = 'אלמנט חדש';
    if(type === 'button') {
        newEl.style.padding = "10px 20px";
        newEl.style.background = "#0071e3";
        newEl.style.color = "white";
        newEl.style.border = "none";
        newEl.style.borderRadius = "8px";
    }
    document.getElementById('site-wrapper').appendChild(newEl);
}

document.getElementById('delete-btn').onclick = () => {
    if (selectedElement) {
        selectedElement.remove();
        selectedElement = null;
    }
};

function setDevice(mode) {
    const wrapper = document.getElementById('site-wrapper');
    if (mode === 'mobile') wrapper.classList.add('mobile');
    else wrapper.classList.remove('mobile');
}
