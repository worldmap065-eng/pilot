<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Pilot CMS | Pro Dashboard</title>
    <style>
        :root { --p-color: #0071e3; }
        body { font-family: -apple-system, system-ui; margin: 0; display: flex; height: 100vh; background: #f5f5f7; }
        
        /* Sidebar */
        .sidebar { width: 350px; background: white; border-left: 1px solid #d2d2d7; display: flex; flex-direction: column; padding: 20px; box-shadow: 5px 0 15px rgba(0,0,0,0.05); z-index: 10; overflow-y: auto; }
        
        /* Preview Area */
        .preview-area { flex: 1; padding: 40px; display: flex; flex-direction: column; align-items: center; background: #e5e5e5; overflow-y: auto; position: relative; }
        .browser-mockup { background: white; width: 100%; max-width: 800px; min-height: 1000px; border-radius: 12px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); padding: 40px; box-sizing: border-box; }

        /* Tabs */
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid #ddd; padding-bottom: 10px; }
        .tab { cursor: pointer; padding: 8px 15px; border-radius: 8px; font-weight: 600; font-size: 13px; }
        .tab.active { background: var(--p-color); color: white; }

        /* Inputs */
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 12px; color: #86868b; margin-bottom: 5px; }
        input, textarea, select { width: 100%; padding: 10px; border: 1px solid #d2d2d7; border-radius: 8px; box-sizing: border-box; }
        
        /* Live Preview Tags */
        .p-hero-t { font-size: 48px; font-weight: 700; color: #1d1d1f; }
        .p-hero-s { font-size: 24px; color: #86868b; }
        .p-btn { display: inline-block; padding: 12px 25px; border-radius: 30px; background: var(--p-color); color: white; margin-top: 20px; }

        .save-bar { position: sticky; bottom: 0; background: white; padding-top: 20px; border-top: 1px solid #eee; }
        .btn-save { width: 100%; padding: 15px; background: var(--p-color); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>Pilot Studio</h2>
    <div class="tabs">
        <div class="tab active" onclick="showTab('content')">תוכן</div>
        <div class="tab" onclick="showTab('design')">עיצוב</div>
        <div class="tab" onclick="showTab('chat')">בוט</div>
    </div>

    <div id="content-tab">
        <div class="input-group">
            <label>כותרת ראשית</label>
            <input type="text" id="in-title" oninput="updatePreview()">
        </div>
        <div class="input-group">
            <label>כותרת משנה</label>
            <textarea id="in-sub" oninput="updatePreview()"></textarea>
        </div>
        <div class="input-group">
            <label>טקסט כפתור</label>
            <input type="text" id="in-btn" oninput="updatePreview()">
        </div>
    </div>

    <div id="design-tab" style="display:none">
        <div class="input-group">
            <label>צבע מותג</label>
            <input type="color" id="in-color" oninput="updatePreview()">
        </div>
        <div class="input-group">
            <label>קימור פינות (px)</label>
            <input type="range" min="0" max="30" id="in-radius" oninput="updatePreview()">
        </div>
    </div>

    <div class="save-bar">
        <input type="password" id="pass" placeholder="סיסמה לשמירה" style="margin-bottom:10px">
        <button class="btn-save" onclick="save()">שמור שינויים לאתר</button>
    </div>
</div>

<div class="preview-area">
    <div style="margin-bottom: 20px; color: #86868b; font-size: 14px;">תצוגה מקדימה (בזמן אמת)</div>
    <div class="browser-mockup" id="mockup">
        <div id="p-hero-t" class="p-hero-t">כותרת האתר</div>
        <div id="p-hero-s" class="p-hero-s">כאן יופיע תיאור העסק שלך</div>
        <div id="p-btn" class="p-btn">לחץ כאן</div>
    </div>
</div>

<script>
    let currentData = {};

    function updatePreview() {
        const title = document.getElementById('in-title').value;
        const sub = document.getElementById('in-sub').value;
        const btn = document.getElementById('in-btn').value;
        const color = document.getElementById('in-color').value;
        const radius = document.getElementById('in-radius').value;

        document.getElementById('p-hero-t').innerText = title;
        document.getElementById('p-hero-s').innerText = sub;
        document.getElementById('p-btn').innerText = btn;
        
        document.documentElement.style.setProperty('--p-color', color);
        document.getElementById('p-btn').style.borderRadius = radius + 'px';
    }

    async function load() {
        const res = await fetch('https://YOUR-RENDER-URL.onrender.com/get-content');
        const data = await res.json();
        currentData = data;
        
        document.getElementById('in-title').value = data.hero.title;
        document.getElementById('in-sub').value = data.hero.subtitle;
        document.getElementById('in-btn').value = "הצטרפו עכשיו"; // ברירת מחדל
        document.getElementById('in-color').value = data.config.primaryColor;
        
        updatePreview();
    }

    function showTab(tab) {
        document.getElementById('content-tab').style.display = tab === 'content' ? 'block' : 'none';
        document.getElementById('design-tab').style.display = tab === 'design' ? 'block' : 'none';
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        event.target.classList.add('active');
    }

    async function save() {
        const password = document.getElementById('pass').value;
        const newContent = {
            config: { primaryColor: document.getElementById('in-color').value, borderRadius: document.getElementById('in-radius').value + "px" },
            hero: { title: document.getElementById('in-title').value, subtitle: document.getElementById('in-sub').value }
        };

        const res = await fetch('https://YOUR-RENDER-URL.onrender.com/update-content', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ password, newContent })
        });
        
        if(res.ok) alert("האתר עודכן בהצלחה!");
        else alert("סיסמה שגויה אחי");
    }

    load();
</script>
</body>
</html>
