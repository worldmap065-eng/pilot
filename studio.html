<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Pilot Studio | Fully Functional</title>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- ×××©×§ ×”×¢×•×¨×š (Studio UI) --- */
        :root { 
            --accent: #0071e3; 
            --bg: #1e1e1e; 
            --panel: #2c2c2e; 
            --border: #3a3a3c;
            --text: #ffffff;
        }
        * { box-sizing: border-box; font-family: 'SF Pro Display', sans-serif; outline: none; }
        body { margin: 0; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* ×¡×¨×’×œ ×¢×œ×™×•×Ÿ */
        .header {
            height: 55px; background: rgba(44, 44, 46, 0.9); backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 100;
        }
        .logo { font-weight: 700; font-size: 15px; letter-spacing: 0.5px; }
        .actions button {
            background: #3a3a3c; border: none; color: white; padding: 8px 16px; 
            border-radius: 8px; font-size: 13px; cursor: pointer; transition: 0.2s; margin-left: 8px;
        }
        .actions button:hover { background: #48484a; }
        .actions button.publish { background: var(--accent); }
        .actions button.publish:hover { background: #0077ed; }

        /* ××–×•×¨ ×”×¢×‘×•×“×” */
        .workspace { flex: 1; display: flex; overflow: hidden; }

        /* ×¡×¨×’×œ ×©×××œ×™ (×¨×›×™×‘×™×) */
        .sidebar-left {
            width: 70px; background: var(--panel); border-left: 1px solid var(--border);
            display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 15px;
        }
        .tool {
            width: 44px; height: 44px; border-radius: 10px; background: #3a3a3c; color: #ccc;
            display: flex; justify-content: center; align-items: center; font-size: 20px; cursor: grab;
            transition: 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .tool:hover { background: var(--accent); color: white; transform: scale(1.05); }
        .tool:active { cursor: grabbing; }

        /* ××–×•×¨ ×”×§× ×‘×¡ (×”××ª×¨) */
        .canvas-area {
            flex: 1; background: #151516; display: flex; justify-content: center; align-items: center;
            padding: 40px; overflow: hidden; position: relative;
            background-image: radial-gradient(#333 1px, transparent 1px); background-size: 20px 20px;
        }
        
        iframe {
            width: 100%; height: 100%; border: none; background: white;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); transition: 0.4s ease;
        }
        iframe.mobile {
            width: 375px; height: 812px; border-radius: 40px; border: 12px solid #000;
        }

        /* ×¡×¨×’×œ ×™×× ×™ (×”×’×“×¨×•×ª) */
        .sidebar-right {
            width: 300px; background: var(--panel); border-right: 1px solid var(--border);
            display: flex; flex-direction: column; padding: 25px; gap: 25px;
        }
        
        .prop-section { border-bottom: 1px solid #3a3a3c; padding-bottom: 20px; }
        .prop-title { font-size: 11px; font-weight: 700; color: #86868b; text-transform: uppercase; margin-bottom: 12px; letter-spacing: 1px; }
        
        .control { margin-bottom: 12px; }
        .control label { display: block; font-size: 12px; color: #aeaeb2; margin-bottom: 6px; }
        .control input {
            width: 100%; background: #1c1c1e; border: 1px solid #3a3a3c; color: white; 
            padding: 10px; border-radius: 8px; font-size: 13px;
        }
        .control input:focus { border-color: var(--accent); }
        .control input[type="color"] { height: 40px; padding: 2px; cursor: pointer; }
        
        .status-msg { text-align: center; color: #636366; font-size: 13px; margin-top: auto; }

    </style>
</head>
<body>

    <div class="header">
        <div class="logo">PILOT STUDIO <span style="font-weight:300; opacity:0.7">PRO</span></div>
        <div class="actions">
            <button onclick="setMode('desktop')">ğŸ–¥ï¸ Desktop</button>
            <button onclick="setMode('mobile')">ğŸ“± Mobile</button>
            <button class="publish" onclick="alert('×”×§×•×“ ××•×›×Ÿ ×œ×™×™×¦×•×!')">Publish</button>
        </div>
    </div>

    <div class="workspace">
        <div class="sidebar-left">
            <div class="tool" draggable="true" ondragstart="drag(event, 'h1')" title="×›×•×ª×¨×ª">H1</div>
            <div class="tool" draggable="true" ondragstart="drag(event, 'p')" title="×˜×§×¡×˜">Aa</div>
            <div class="tool" draggable="true" ondragstart="drag(event, 'button')" title="×›×¤×ª×•×¨">ğŸ”˜</div>
            <div class="tool" draggable="true" ondragstart="drag(event, 'img')" title="×ª××•× ×”">ğŸ–¼ï¸</div>
        </div>

        <div class="canvas-area" id="canvas-dropzone">
            <iframe id="editor-frame"></iframe>
        </div>

        <div class="sidebar-right">
            <div class="prop-section">
                <div class="prop-title">×ª×•×›×Ÿ</div>
                <div class="control">
                    <label>×˜×§×¡×˜</label>
                    <input type="text" id="inp-text" placeholder="×‘×—×¨ ××œ×× ×˜...">
                </div>
            </div>

            <div class="prop-section">
                <div class="prop-title">×¢×™×¦×•×‘</div>
                <div class="control">
                    <label>×¦×‘×¢ ×˜×§×¡×˜</label>
                    <input type="color" id="inp-color">
                </div>
                <div class="control">
                    <label>×¦×‘×¢ ×¨×§×¢</label>
                    <input type="color" id="inp-bg">
                </div>
                <div class="control">
                    <label>×’×•×“×œ (PX)</label>
                    <input type="number" id="inp-size">
                </div>
                <div class="control">
                    <label>×¢×™×’×•×œ ×¤×™× ×•×ª</label>
                    <input type="number" id="inp-radius">
                </div>
            </div>

            <button onclick="deleteSelected()" style="background:#ff453a; color:white; border:none; padding:12px; border-radius:8px; cursor:pointer;">××—×§ ××œ×× ×˜</button>
            <div class="status-msg" id="status">×œ× × ×‘×—×¨ ×¤×¨×™×˜</div>
        </div>
    </div>

<script>
    const iframe = document.getElementById('editor-frame');
    let selectedEl = null;

    // 1. ×™×¦×™×¨×ª ×”××ª×¨ ×‘×ª×•×š ×”-iframe ×‘××•×¤×Ÿ ××•×˜×•××˜×™ (×¢×•×§×£ ×‘×¢×™×•×ª ××‘×˜×—×”)
    const initialContent = `
        <!DOCTYPE html>
        <html dir="rtl">
        <head>
            <style>
                body { font-family: -apple-system, sans-serif; padding: 40px; background: white; }
                h1 { color: #1d1d1f; }
                p { color: #86868b; line-height: 1.5; }
                button { background: #0071e3; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-size: 16px; cursor: pointer; }
                .hovered { outline: 2px dashed #0071e3; }
                .selected { outline: 3px solid #0071e3; position: relative; z-index: 10; }
            </style>
        </head>
        <body>
            <h1 id="demo-title">×‘×¨×•×›×™× ×”×‘××™× ×œ××ª×¨ ×©×œ×š</h1>
            <p>×œ×—×¥ ×¢×œ ×˜×§×¡×˜ ××• ×›×¤×ª×•×¨ ×›×“×™ ×œ×¢×¨×•×š ××•×ª×• ×‘×¤×× ×œ ×‘×¦×“ ×™××™×Ÿ.</p>
            <button>×œ×—×¥ ×›××Ÿ</button>
        </body>
        </html>
    `;

    // ×›×ª×™×‘×ª ×”×ª×•×›×Ÿ ×œ×ª×•×š ×”-iframe
    const doc = iframe.contentWindow.document;
    doc.open();
    doc.write(initialContent);
    doc.close();

    // 2. ×—×™×‘×•×¨ ××™×¨×•×¢×™× (×œ×—×™×¦×” ×¢×œ ××œ×× ×˜×™× ×‘×ª×•×š ×”××ª×¨)
    iframe.contentWindow.document.body.addEventListener('click', function(e) {
        if(e.target !== e.currentTarget) {
            selectItem(e.target);
        }
    });

    // 3. ×¤×•× ×§×¦×™×™×ª ×‘×—×™×¨×” - ××¢×“×›× ×ª ××ª ×”×¤×× ×œ ×”×™×× ×™
    function selectItem(el) {
        // ×”×¡×¨×ª ×‘×—×™×¨×” ×§×•×“××ª
        if(selectedEl) selectedEl.classList.remove('selected');
        
        selectedEl = el;
        selectedEl.classList.add('selected');
        
        document.getElementById('status').innerText = "×¢×•×¨×š ×›×¢×ª: " + el.tagName;

        // ×˜×¢×™× ×ª × ×ª×•× ×™× ×œ×©×“×•×ª
        document.getElementById('inp-text').value = el.innerText;
        
        const style = window.getComputedStyle(el); // Computed style emulation
        // ×”×¢×¨×”: ×œ×§×‘×œ×ª ×¢×¨×›×™× ××“×•×™×§×™× ×× ×—× ×• ××©×ª××©×™× ×‘×˜×¨×™×§ ×¤×©×•×˜ ×›××Ÿ
        document.getElementById('inp-size').value = parseInt(el.style.fontSize) || 16;
        document.getElementById('inp-radius').value = parseInt(el.style.borderRadius) || 0;
        
        // ×¦×‘×¢×™× - ×”××¨×” ×¤×©×•×˜×” (×”×¢×¨×”: ×“×¤×“×¤× ×™× ××—×–×™×¨×™× RGB, input ×“×•×¨×© HEX. ×›××Ÿ × ×©×ª××© ×‘×¢×¨×š ×× ×§×™×™× ×‘-style)
        // ×œ×¦×•×¨×š ×”×¤×©×˜×•×ª ×‘×§×•×“ ×”×–×”, ×× ××™×Ÿ ×¦×‘×¢ ××•×’×“×¨ ×‘-style, ×–×” ×™×™×©××¨ ×©×—×•×¨ ×‘×‘×•×¨×¨
    }

    // 4. ×¢×“×›×•×Ÿ ×‘×–××Ÿ ×××ª (××”×¤×× ×œ ×œ××ª×¨)
    
    document.getElementById('inp-text').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.innerText = e.target.value;
    });

    document.getElementById('inp-color').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.style.color = e.target.value;
    });

    document.getElementById('inp-bg').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.style.backgroundColor = e.target.value;
    });

    document.getElementById('inp-size').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.style.fontSize = e.target.value + 'px';
    });

    document.getElementById('inp-radius').addEventListener('input', (e) => {
        if(selectedEl) selectedEl.style.borderRadius = e.target.value + 'px';
    });

    function deleteSelected() {
        if(selectedEl) {
            selectedEl.remove();
            selectedEl = null;
            document.getElementById('status').innerText = "× ××—×§";
            document.getElementById('inp-text').value = "";
        }
    }

    // 5. ×’×¨×™×¨×” ×•×”×•×¡×¤×” (Drag & Drop) ×œ×ª×•×š ×”-iframe
    // ×”×¢×¨×”: ×’×¨×™×¨×” ×œ×ª×•×š iframe ×“×•×¨×©×ª ×˜×™×¤×•×œ ××•×¨×›×‘ ×‘-coordinates.
    // ×‘×’×¨×¡×” ×–×• × ×©×ª××© ×‘"×“××‘×œ ×§×œ×™×§" ×¢×œ ×”×›×œ×™× ×‘×¦×“ ×©×××œ ×œ×”×•×¡×¤×” ××”×™×¨×” ×œ××¨×›×– ×”××ª×¨.
    
    document.querySelectorAll('.tool').forEach(tool => {
        tool.addEventListener('click', () => {
           const type = tool.getAttribute('title'); // h1, p, etc mapping needed logic but simplifying:
           let tag = 'div';
           let text = '×—×“×©';
           
           if(tool.innerText === 'H1') { tag = 'h1'; text = '×›×•×ª×¨×ª ×—×“×©×”'; }
           if(tool.innerText === 'Aa') { tag = 'p'; text = '×˜×§×¡×˜ ×—×“×©'; }
           if(tool.innerText.includes('ğŸ”˜')) { tag = 'button'; text = '×›×¤×ª×•×¨'; }
           
           const newEl = iframe.contentWindow.document.createElement(tag);
           newEl.innerText = text;
           if(tag === 'button') {
               newEl.style.background = '#0071e3'; newEl.style.color='white'; newEl.style.padding='10px 20px'; newEl.style.border='none'; newEl.style.borderRadius='8px';
           }
           iframe.contentWindow.document.body.appendChild(newEl);
           selectItem(newEl);
        });
    });

    function setMode(mode) {
        if(mode === 'mobile') iframe.className = 'mobile';
        else iframe.className = '';
    }

</script>

</body>
</html>
